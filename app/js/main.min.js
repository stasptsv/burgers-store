window.addEventListener('DOMContentLoaded', function() {

	// Feedback Popup
	let popupFeedback = document.querySelector('.feedback-popup');
	let viewBtn = document.querySelectorAll('.feedback-view');
	let closeBtn = document.querySelectorAll('.feedback-full__close');

	// Open Popup
	viewBtn.forEach(function (item) {
		item.addEventListener('click', (event) => {
			event.preventDefault();
			popupFeedback.classList.add('popup-show');
		});
	});

	// Close Popup
	closeBtn.forEach(function(item) {
		item.addEventListener('click', () => {
			popupFeedback.classList.remove('popup-show');
		});
	});

	// Vertical Accordeon
	let accordeon = (function() {
		let accContent = document.querySelector('.team-list');
		let isClicked = false;
		let isAnimOver = true;
	
		let _toggleAccordeon = function(elem) {
			if (isClicked) {
				let activeItem = accContent.querySelector('.active-item__team');
				activeItem.classList.remove('active-item__team');
				activeItem.querySelector('.team-list__item-content').classList.remove('show');
			}
			elem.classList.toggle('active-item__team');
			let elemContent = elem.querySelector('.team-list__item-content');
			elemContent.classList.add('show')
			isClicked = true;
		}
	
		let addListener = function() {
			accContent.addEventListener('click', function(event) {
				let itemClicked = event.target.parentElement;
				let isTrigger = (event.target.className === 'team-trigger');
				if (isTrigger && isAnimOver
					&& itemClicked.classList.contains('active-item__team')) {
						itemClicked.classList.remove('active-item__team');
						itemClicked.querySelector('.team-list__item-content').classList.remove('show');
						isClicked = false;
						isAnimOver = false;
						setTimeout(function() {isAnimOver = true;}, 600);
				} else if (isTrigger && isAnimOver) {
					_toggleAccordeon(itemClicked);
					isAnimOver = false;
					setTimeout(function() {isAnimOver = true;}, 600);
				}
			})
		}
	
		return {
			init: addListener
		};
	})();
	accordeon.init();

	
	// Horizontal Accordeon
	let accordeonHorizontal = (function() {
		let accordeon = document.querySelector('.menu-list');
		let triggerWidth;
		let isClicked = false;
		let isPhone = window.innerWidth <= 480;
		
		if (isPhone) {
			accordeon.style.left = accordeon.getBoundingClientRect().left + 'px';
		}
	
		let widthContent = function() {
			let itemQuantity = 3;
			
			if (isPhone) {itemQuantity = 1;}
			let computedWidth = window.innerWidth - itemQuantity * triggerWidth;
	
			return computedWidth > 540 ? 540 : computedWidth;
		}
	
		let toggleAccordeon = function(elem) {
			let initialLeft = window.innerWidth - 3 * triggerWidth + 'px';
			
			if (isClicked) {
				let isOpenedItemClicked = elem.classList.contains('active-acc');
				let activeItem = accordeon.querySelector('.active-acc');
				
				activeItem.classList.toggle('active-acc');
				activeItem.querySelector('.menu-item__content').style.width = 0;
				isClicked = false;
				
				if (isOpenedItemClicked) {
					if (isPhone) {
						accordeon.style.left = initialLeft;}
					return;
				}
			}
			elem.classList.toggle('active-acc');
			
			let elemContent = elem.querySelector('.menu-item__content');
			elemContent.style.width = widthContent() + 'px';
			
			if (isPhone) {
				accordeon.style.left = [].indexOf.call(accordeon.children, elem) * (-(triggerWidth)) + 'px';
			}
			isClicked = true;
		}
	
		let addListeners = function() {
			accordeon.addEventListener('click', function(event) {
				let target = event.target.closest('.menu-trigger');
			
				isPhone = window.innerWidth <= 480;
				triggerWidth = parseInt(getComputedStyle(accordeon.querySelector('.menu-trigger')).width);
				if (target) {
					toggleAccordeon(target.parentElement);}
			})
	
			let crosses = accordeon.querySelectorAll('.menu-item__close');
			for (let i = 0; i < crosses.length; i++) {
				crosses[i].addEventListener('click', function() {
				toggleAccordeon(crosses[i].closest('.active-acc'));
			});
			}
		}
		return {init: addListeners};
	})();
	
	accordeonHorizontal.init();
	

	// Form 
	let message = {
			loading: 'Загрузка...',
			success: 'Спасибо! Скоро мы с вами свяжемся!',
			failure: 'Что-то пошло не так...'
	}

	let form = document.querySelector('.order-form'),
			input = document.querySelector('input'),
			modal =	document.querySelector('.modal'),
			statusMessage = modal.querySelector('.modal-title'),
			modalBtnClose = modal.querySelector('.button-modal');

	modalBtnClose.addEventListener('click', (event) => {
		event.preventDefault();
		modal.classList.remove('modal-show');
	})

	form.addEventListener('submit', function(event) {
		event.preventDefault();

		let request = new XMLHttpRequest();

		request.open('POST', 'server.php');
		request.setRequestHeader('Content-type', 'application/json; charset=utf-8');

		let formData = new FormData(form);

		let obj = {};
		formData.forEach(function(value, key) {
				obj[key] = value;
		});
		
		let json = JSON.stringify(obj);

		request.send(json);

		request.addEventListener('readystatechange', function() {
			if (request.readyState < 4) {
				modal.classList.add('modal-show');
				statusMessage.innerHTML = message.loading;
			} else if(request.readyState === 4 && request.status == 200) {
				modal.classList.add('modal-show');	
				statusMessage.innerHTML = message.success;
			} else {
					statusMessage.classList.add('modal-show');
					statusMessage.innerHTML = message.failure;
				}
			});

		for (let i = 0; i < input.length; i++) {
			input[i].value = '';
		}
	});

	// Open Mobile Navigation
	function openNavigation() {
		let mobileNav = document.querySelector('.mobile-menu');
		
		mobileNav.style.height = '100%';
	}

	function closeNavigation() {
		let mobileNav = document.querySelector('.mobile-menu');
		
		mobileNav.style.height = '0';
	}

	let humburger = document.querySelector('.hamburger');
	let btnClose = document.querySelector('.navigation-mobile__close');

	humburger.addEventListener('click', (event) => {
		event.preventDefault();
		openNavigation();
	});

	btnClose.addEventListener('click', (event) => {
		event.preventDefault();
		closeNavigation();
	});

	// Slider
	let slideIndex = 1;
	let slidesImage = document.querySelectorAll('.slider-item');
	let slidesTitle = document.querySelectorAll('.section-title__burgers');
	let slidesDescr = document.querySelectorAll('.burger-descr');
	let arrowPrev = document.querySelector('.arrow-prev');
	let arrowNext = document.querySelector('.arrow-next');
	let price = document.querySelectorAll('.burger-price');

	showSlidesImage(slideIndex);
	
	function showSlidesImage(n) {
		if (n > slidesImage.length) {
			slideIndex = 1;
		} if (n < 1) {
			slideIndex = slidesImage.length;
		}

		slidesImage.forEach((item) => { // Перебор всех слайдов
			item.style.display = 'none'; // Скрыть все слайды
		});

		slidesTitle.forEach((item) => {
			item.style.display = 'none';
		});

		price.forEach((item) => {
			item.style.display = 'none'
		})

		slidesDescr.forEach((item) => {
			item.style.display = 'none';
		});

		slidesImage[slideIndex - 1].style.display = 'block'; // Показать первый слайд
		slidesTitle[slideIndex - 1].style.display = 'block';
		slidesDescr[slideIndex - 1].style.display = 'block'; 
		price[slideIndex - 1].style.display = 'block';
	}

	function nextSlides(n) { // Смена слайдов
		showSlidesImage(slideIndex += n);
	}

	function currentSlide(n) {
		showSlidesImage(slideIndex = n);
	}

	arrowPrev.addEventListener('click', function() {
		nextSlides(-1);
	});

	arrowNext.addEventListener('click', function() {
		nextSlides(1);
	});

	// Video
	function findVideos() {
		let videos = document.querySelectorAll('.video');
	
		for (let i = 0; i < videos.length; i++) {
			setupVideo(videos[i]);
		}
	}
	
	function setupVideo(video) {
		let link = video.querySelector('.video-link');
		let media = video.querySelector('.video-media');
		let button = video.querySelector('.video-button');
		let id = parseMediaURL(media);
	
		video.addEventListener('click', () => {
			let iframe = createIframe(id);
	
			link.remove();
			button.remove();
			video.appendChild(iframe);
		});
	
		link.removeAttribute('href');
		video.classList.add('video__enabled');
	}
	
	function parseMediaURL(media) {
		let regexp = /https:\/\/i\.ytimg\.com\/vi\/([a-zA-Z0-9_-]+)\/mqdefault\.jpg/i;
		let url = media.src;
		let match = url.match(regexp);
	
		return match[1];
	}
	
	function createIframe(id) {
		let iframe = document.createElement('iframe');
	
		iframe.setAttribute('allowfullscreen', '');
		iframe.setAttribute('allow', 'autoplay');
		iframe.setAttribute('src', generateURL(id));
		iframe.classList.add('video-media');
	
		return iframe;
	}
	
	function generateURL(id) {
		let query = '?rel=0&showinfo=0&autoplay=1';
	
		return 'https://www.youtube.com/embed/' + id + query;
	}
	
	findVideos();
	

	// Yandex Map 
	ymaps.ready();

	let myPlacemarks = [
		{
			latitude: 59.97,
			longitude: 30.31,
			hintContent: 'ул. Литераторов, д. 19А',
			balloonContent: [
				'<div class="map-balloon">',
					'<svg class="map-balloon__img">',
						'<use xlink:href="image/svg/sprite.svg#logo"></use>',	
					'</svg>',
					'ул. Литераторов, д. 19А',
				'</div>'
			]
		},
		{
			latitude: 59.945,  
			longitude: 30.38,
			hintContent: 'Калужский переулок, 9',
			balloonContent: [
				'<div class="map-balloon">',
					'<svg class="map-balloon__img" >',
						'<use xlink:href="image/svg/sprite.svg#logo"></use>',	
					'</svg>',
					'Калужский переулок, 9',
				'</div>'
			]
		},
		{
			latitude: 59.89,
			longitude: 30.32,
			hintContent: 'Московский проспект, 109',
			balloonContent: [
				'<div class="map-balloon">',
					'<svg class="map-balloon__img">',
						'<use xlink:href="image/svg/sprite.svg#logo"></use>',	
					'</svg>',
					'Московский проспект, 109',
				'</div>'
			]
		},
		{
			latitude: 59.918,
			longitude: 30.493,
			hintContent: 'улица Подвойского, 42',
			balloonContent: [
				'<div class="map-balloon">',
					'<svg class="map-balloon__img">',
						'<use xlink:href="image/svg/sprite.svg#logo"></use>',	
					'</svg>',
					'улица Подвойского, 42',
				'</div>'
			]
		}
	];

	ymaps.ready(function () {     
		let myMap = new ymaps.Map('map', {
				center: [59.94, 30.32],
				zoom: 11,
				controls: ['zoomControl'],
				behaviors: ['drag']
		}, {
				searchControlProvider: 'yandex#search'
		});

		let customIcon = ymaps.templateLayoutFactory.createClass('<svg width="46" height="57"><use xlink:href="image/svg/sprite.svg#map-marker"></use></svg>');

		myPlacemarks.forEach(function(obj) {
			let myPlacemark = new ymaps.Placemark([obj.latitude, obj.longitude], { 
				hintContent: obj.hintContent, 
				balloonContent: obj.balloonContent.join('') 
			},
			{
				iconLayout: 'default#image',
				iconImageHref: 'image/svg/map-marker.svg',
				iconImageSize: [46, 57],
				iconImageOffset: [-23, -57]
			});

				myMap.geoObjects.add(myPlacemark);
		});
	});
	
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJtYWluLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24oKSB7XHJcblxyXG5cdC8vIEZlZWRiYWNrIFBvcHVwXHJcblx0bGV0IHBvcHVwRmVlZGJhY2sgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZmVlZGJhY2stcG9wdXAnKTtcclxuXHRsZXQgdmlld0J0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5mZWVkYmFjay12aWV3Jyk7XHJcblx0bGV0IGNsb3NlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmZlZWRiYWNrLWZ1bGxfX2Nsb3NlJyk7XHJcblxyXG5cdC8vIE9wZW4gUG9wdXBcclxuXHR2aWV3QnRuLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcclxuXHRcdGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZlbnQpID0+IHtcclxuXHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuXHRcdFx0cG9wdXBGZWVkYmFjay5jbGFzc0xpc3QuYWRkKCdwb3B1cC1zaG93Jyk7XHJcblx0XHR9KTtcclxuXHR9KTtcclxuXHJcblx0Ly8gQ2xvc2UgUG9wdXBcclxuXHRjbG9zZUJ0bi5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcclxuXHRcdGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcblx0XHRcdHBvcHVwRmVlZGJhY2suY2xhc3NMaXN0LnJlbW92ZSgncG9wdXAtc2hvdycpO1xyXG5cdFx0fSk7XHJcblx0fSk7XHJcblxyXG5cdC8vIFZlcnRpY2FsIEFjY29yZGVvblxyXG5cdGxldCBhY2NvcmRlb24gPSAoZnVuY3Rpb24oKSB7XHJcblx0XHRsZXQgYWNjQ29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50ZWFtLWxpc3QnKTtcclxuXHRcdGxldCBpc0NsaWNrZWQgPSBmYWxzZTtcclxuXHRcdGxldCBpc0FuaW1PdmVyID0gdHJ1ZTtcclxuXHRcclxuXHRcdGxldCBfdG9nZ2xlQWNjb3JkZW9uID0gZnVuY3Rpb24oZWxlbSkge1xyXG5cdFx0XHRpZiAoaXNDbGlja2VkKSB7XHJcblx0XHRcdFx0bGV0IGFjdGl2ZUl0ZW0gPSBhY2NDb250ZW50LnF1ZXJ5U2VsZWN0b3IoJy5hY3RpdmUtaXRlbV9fdGVhbScpO1xyXG5cdFx0XHRcdGFjdGl2ZUl0ZW0uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlLWl0ZW1fX3RlYW0nKTtcclxuXHRcdFx0XHRhY3RpdmVJdGVtLnF1ZXJ5U2VsZWN0b3IoJy50ZWFtLWxpc3RfX2l0ZW0tY29udGVudCcpLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRlbGVtLmNsYXNzTGlzdC50b2dnbGUoJ2FjdGl2ZS1pdGVtX190ZWFtJyk7XHJcblx0XHRcdGxldCBlbGVtQ29udGVudCA9IGVsZW0ucXVlcnlTZWxlY3RvcignLnRlYW0tbGlzdF9faXRlbS1jb250ZW50Jyk7XHJcblx0XHRcdGVsZW1Db250ZW50LmNsYXNzTGlzdC5hZGQoJ3Nob3cnKVxyXG5cdFx0XHRpc0NsaWNrZWQgPSB0cnVlO1xyXG5cdFx0fVxyXG5cdFxyXG5cdFx0bGV0IGFkZExpc3RlbmVyID0gZnVuY3Rpb24oKSB7XHJcblx0XHRcdGFjY0NvbnRlbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihldmVudCkge1xyXG5cdFx0XHRcdGxldCBpdGVtQ2xpY2tlZCA9IGV2ZW50LnRhcmdldC5wYXJlbnRFbGVtZW50O1xyXG5cdFx0XHRcdGxldCBpc1RyaWdnZXIgPSAoZXZlbnQudGFyZ2V0LmNsYXNzTmFtZSA9PT0gJ3RlYW0tdHJpZ2dlcicpO1xyXG5cdFx0XHRcdGlmIChpc1RyaWdnZXIgJiYgaXNBbmltT3ZlclxyXG5cdFx0XHRcdFx0JiYgaXRlbUNsaWNrZWQuY2xhc3NMaXN0LmNvbnRhaW5zKCdhY3RpdmUtaXRlbV9fdGVhbScpKSB7XHJcblx0XHRcdFx0XHRcdGl0ZW1DbGlja2VkLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZS1pdGVtX190ZWFtJyk7XHJcblx0XHRcdFx0XHRcdGl0ZW1DbGlja2VkLnF1ZXJ5U2VsZWN0b3IoJy50ZWFtLWxpc3RfX2l0ZW0tY29udGVudCcpLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTtcclxuXHRcdFx0XHRcdFx0aXNDbGlja2VkID0gZmFsc2U7XHJcblx0XHRcdFx0XHRcdGlzQW5pbU92ZXIgPSBmYWxzZTtcclxuXHRcdFx0XHRcdFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtpc0FuaW1PdmVyID0gdHJ1ZTt9LCA2MDApO1xyXG5cdFx0XHRcdH0gZWxzZSBpZiAoaXNUcmlnZ2VyICYmIGlzQW5pbU92ZXIpIHtcclxuXHRcdFx0XHRcdF90b2dnbGVBY2NvcmRlb24oaXRlbUNsaWNrZWQpO1xyXG5cdFx0XHRcdFx0aXNBbmltT3ZlciA9IGZhbHNlO1xyXG5cdFx0XHRcdFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtpc0FuaW1PdmVyID0gdHJ1ZTt9LCA2MDApO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSlcclxuXHRcdH1cclxuXHRcclxuXHRcdHJldHVybiB7XHJcblx0XHRcdGluaXQ6IGFkZExpc3RlbmVyXHJcblx0XHR9O1xyXG5cdH0pKCk7XHJcblx0YWNjb3JkZW9uLmluaXQoKTtcclxuXHJcblx0XHJcblx0Ly8gSG9yaXpvbnRhbCBBY2NvcmRlb25cclxuXHRsZXQgYWNjb3JkZW9uSG9yaXpvbnRhbCA9IChmdW5jdGlvbigpIHtcclxuXHRcdGxldCBhY2NvcmRlb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubWVudS1saXN0Jyk7XHJcblx0XHRsZXQgdHJpZ2dlcldpZHRoO1xyXG5cdFx0bGV0IGlzQ2xpY2tlZCA9IGZhbHNlO1xyXG5cdFx0bGV0IGlzUGhvbmUgPSB3aW5kb3cuaW5uZXJXaWR0aCA8PSA0ODA7XHJcblx0XHRcclxuXHRcdGlmIChpc1Bob25lKSB7XHJcblx0XHRcdGFjY29yZGVvbi5zdHlsZS5sZWZ0ID0gYWNjb3JkZW9uLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQgKyAncHgnO1xyXG5cdFx0fVxyXG5cdFxyXG5cdFx0bGV0IHdpZHRoQ29udGVudCA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRsZXQgaXRlbVF1YW50aXR5ID0gMztcclxuXHRcdFx0XHJcblx0XHRcdGlmIChpc1Bob25lKSB7aXRlbVF1YW50aXR5ID0gMTt9XHJcblx0XHRcdGxldCBjb21wdXRlZFdpZHRoID0gd2luZG93LmlubmVyV2lkdGggLSBpdGVtUXVhbnRpdHkgKiB0cmlnZ2VyV2lkdGg7XHJcblx0XHJcblx0XHRcdHJldHVybiBjb21wdXRlZFdpZHRoID4gNTQwID8gNTQwIDogY29tcHV0ZWRXaWR0aDtcclxuXHRcdH1cclxuXHRcclxuXHRcdGxldCB0b2dnbGVBY2NvcmRlb24gPSBmdW5jdGlvbihlbGVtKSB7XHJcblx0XHRcdGxldCBpbml0aWFsTGVmdCA9IHdpbmRvdy5pbm5lcldpZHRoIC0gMyAqIHRyaWdnZXJXaWR0aCArICdweCc7XHJcblx0XHRcdFxyXG5cdFx0XHRpZiAoaXNDbGlja2VkKSB7XHJcblx0XHRcdFx0bGV0IGlzT3BlbmVkSXRlbUNsaWNrZWQgPSBlbGVtLmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlLWFjYycpO1xyXG5cdFx0XHRcdGxldCBhY3RpdmVJdGVtID0gYWNjb3JkZW9uLnF1ZXJ5U2VsZWN0b3IoJy5hY3RpdmUtYWNjJyk7XHJcblx0XHRcdFx0XHJcblx0XHRcdFx0YWN0aXZlSXRlbS5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUtYWNjJyk7XHJcblx0XHRcdFx0YWN0aXZlSXRlbS5xdWVyeVNlbGVjdG9yKCcubWVudS1pdGVtX19jb250ZW50Jykuc3R5bGUud2lkdGggPSAwO1xyXG5cdFx0XHRcdGlzQ2xpY2tlZCA9IGZhbHNlO1xyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdGlmIChpc09wZW5lZEl0ZW1DbGlja2VkKSB7XHJcblx0XHRcdFx0XHRpZiAoaXNQaG9uZSkge1xyXG5cdFx0XHRcdFx0XHRhY2NvcmRlb24uc3R5bGUubGVmdCA9IGluaXRpYWxMZWZ0O31cclxuXHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxlbS5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUtYWNjJyk7XHJcblx0XHRcdFxyXG5cdFx0XHRsZXQgZWxlbUNvbnRlbnQgPSBlbGVtLnF1ZXJ5U2VsZWN0b3IoJy5tZW51LWl0ZW1fX2NvbnRlbnQnKTtcclxuXHRcdFx0ZWxlbUNvbnRlbnQuc3R5bGUud2lkdGggPSB3aWR0aENvbnRlbnQoKSArICdweCc7XHJcblx0XHRcdFxyXG5cdFx0XHRpZiAoaXNQaG9uZSkge1xyXG5cdFx0XHRcdGFjY29yZGVvbi5zdHlsZS5sZWZ0ID0gW10uaW5kZXhPZi5jYWxsKGFjY29yZGVvbi5jaGlsZHJlbiwgZWxlbSkgKiAoLSh0cmlnZ2VyV2lkdGgpKSArICdweCc7XHJcblx0XHRcdH1cclxuXHRcdFx0aXNDbGlja2VkID0gdHJ1ZTtcclxuXHRcdH1cclxuXHRcclxuXHRcdGxldCBhZGRMaXN0ZW5lcnMgPSBmdW5jdGlvbigpIHtcclxuXHRcdFx0YWNjb3JkZW9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZXZlbnQpIHtcclxuXHRcdFx0XHRsZXQgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJy5tZW51LXRyaWdnZXInKTtcclxuXHRcdFx0XHJcblx0XHRcdFx0aXNQaG9uZSA9IHdpbmRvdy5pbm5lcldpZHRoIDw9IDQ4MDtcclxuXHRcdFx0XHR0cmlnZ2VyV2lkdGggPSBwYXJzZUludChnZXRDb21wdXRlZFN0eWxlKGFjY29yZGVvbi5xdWVyeVNlbGVjdG9yKCcubWVudS10cmlnZ2VyJykpLndpZHRoKTtcclxuXHRcdFx0XHRpZiAodGFyZ2V0KSB7XHJcblx0XHRcdFx0XHR0b2dnbGVBY2NvcmRlb24odGFyZ2V0LnBhcmVudEVsZW1lbnQpO31cclxuXHRcdFx0fSlcclxuXHRcclxuXHRcdFx0bGV0IGNyb3NzZXMgPSBhY2NvcmRlb24ucXVlcnlTZWxlY3RvckFsbCgnLm1lbnUtaXRlbV9fY2xvc2UnKTtcclxuXHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBjcm9zc2VzLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdFx0Y3Jvc3Nlc1tpXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHRvZ2dsZUFjY29yZGVvbihjcm9zc2VzW2ldLmNsb3Nlc3QoJy5hY3RpdmUtYWNjJykpO1xyXG5cdFx0XHR9KTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHtpbml0OiBhZGRMaXN0ZW5lcnN9O1xyXG5cdH0pKCk7XHJcblx0XHJcblx0YWNjb3JkZW9uSG9yaXpvbnRhbC5pbml0KCk7XHJcblx0XHJcblxyXG5cdC8vIEZvcm0gXHJcblx0bGV0IG1lc3NhZ2UgPSB7XHJcblx0XHRcdGxvYWRpbmc6ICfQl9Cw0LPRgNGD0LfQutCwLi4uJyxcclxuXHRcdFx0c3VjY2VzczogJ9Ch0L/QsNGB0LjQsdC+ISDQodC60L7RgNC+INC80Ysg0YEg0LLQsNC80Lgg0YHQstGP0LbQtdC80YHRjyEnLFxyXG5cdFx0XHRmYWlsdXJlOiAn0KfRgtC+LdGC0L4g0L/QvtGI0LvQviDQvdC1INGC0LDQui4uLidcclxuXHR9XHJcblxyXG5cdGxldCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm9yZGVyLWZvcm0nKSxcclxuXHRcdFx0aW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dCcpLFxyXG5cdFx0XHRtb2RhbCA9XHRkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWwnKSxcclxuXHRcdFx0c3RhdHVzTWVzc2FnZSA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC10aXRsZScpLFxyXG5cdFx0XHRtb2RhbEJ0bkNsb3NlID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmJ1dHRvbi1tb2RhbCcpO1xyXG5cclxuXHRtb2RhbEJ0bkNsb3NlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2ZW50KSA9PiB7XHJcblx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0bW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnbW9kYWwtc2hvdycpO1xyXG5cdH0pXHJcblxyXG5cdGZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgZnVuY3Rpb24oZXZlbnQpIHtcclxuXHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG5cdFx0bGV0IHJlcXVlc3QgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcclxuXHJcblx0XHRyZXF1ZXN0Lm9wZW4oJ1BPU1QnLCAnc2VydmVyLnBocCcpO1xyXG5cdFx0cmVxdWVzdC5zZXRSZXF1ZXN0SGVhZGVyKCdDb250ZW50LXR5cGUnLCAnYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD11dGYtOCcpO1xyXG5cclxuXHRcdGxldCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YShmb3JtKTtcclxuXHJcblx0XHRsZXQgb2JqID0ge307XHJcblx0XHRmb3JtRGF0YS5mb3JFYWNoKGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcclxuXHRcdFx0XHRvYmpba2V5XSA9IHZhbHVlO1xyXG5cdFx0fSk7XHJcblx0XHRcclxuXHRcdGxldCBqc29uID0gSlNPTi5zdHJpbmdpZnkob2JqKTtcclxuXHJcblx0XHRyZXF1ZXN0LnNlbmQoanNvbik7XHJcblxyXG5cdFx0cmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdyZWFkeXN0YXRlY2hhbmdlJywgZnVuY3Rpb24oKSB7XHJcblx0XHRcdGlmIChyZXF1ZXN0LnJlYWR5U3RhdGUgPCA0KSB7XHJcblx0XHRcdFx0bW9kYWwuY2xhc3NMaXN0LmFkZCgnbW9kYWwtc2hvdycpO1xyXG5cdFx0XHRcdHN0YXR1c01lc3NhZ2UuaW5uZXJIVE1MID0gbWVzc2FnZS5sb2FkaW5nO1xyXG5cdFx0XHR9IGVsc2UgaWYocmVxdWVzdC5yZWFkeVN0YXRlID09PSA0ICYmIHJlcXVlc3Quc3RhdHVzID09IDIwMCkge1xyXG5cdFx0XHRcdG1vZGFsLmNsYXNzTGlzdC5hZGQoJ21vZGFsLXNob3cnKTtcdFxyXG5cdFx0XHRcdHN0YXR1c01lc3NhZ2UuaW5uZXJIVE1MID0gbWVzc2FnZS5zdWNjZXNzO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0c3RhdHVzTWVzc2FnZS5jbGFzc0xpc3QuYWRkKCdtb2RhbC1zaG93Jyk7XHJcblx0XHRcdFx0XHRzdGF0dXNNZXNzYWdlLmlubmVySFRNTCA9IG1lc3NhZ2UuZmFpbHVyZTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgaW5wdXQubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0aW5wdXRbaV0udmFsdWUgPSAnJztcclxuXHRcdH1cclxuXHR9KTtcclxuXHJcblx0Ly8gT3BlbiBNb2JpbGUgTmF2aWdhdGlvblxyXG5cdGZ1bmN0aW9uIG9wZW5OYXZpZ2F0aW9uKCkge1xyXG5cdFx0bGV0IG1vYmlsZU5hdiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2JpbGUtbWVudScpO1xyXG5cdFx0XHJcblx0XHRtb2JpbGVOYXYuc3R5bGUuaGVpZ2h0ID0gJzEwMCUnO1xyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gY2xvc2VOYXZpZ2F0aW9uKCkge1xyXG5cdFx0bGV0IG1vYmlsZU5hdiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2JpbGUtbWVudScpO1xyXG5cdFx0XHJcblx0XHRtb2JpbGVOYXYuc3R5bGUuaGVpZ2h0ID0gJzAnO1xyXG5cdH1cclxuXHJcblx0bGV0IGh1bWJ1cmdlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oYW1idXJnZXInKTtcclxuXHRsZXQgYnRuQ2xvc2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubmF2aWdhdGlvbi1tb2JpbGVfX2Nsb3NlJyk7XHJcblxyXG5cdGh1bWJ1cmdlci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldmVudCkgPT4ge1xyXG5cdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuXHRcdG9wZW5OYXZpZ2F0aW9uKCk7XHJcblx0fSk7XHJcblxyXG5cdGJ0bkNsb3NlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2ZW50KSA9PiB7XHJcblx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0Y2xvc2VOYXZpZ2F0aW9uKCk7XHJcblx0fSk7XHJcblxyXG5cdC8vIFNsaWRlclxyXG5cdGxldCBzbGlkZUluZGV4ID0gMTtcclxuXHRsZXQgc2xpZGVzSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2xpZGVyLWl0ZW0nKTtcclxuXHRsZXQgc2xpZGVzVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2VjdGlvbi10aXRsZV9fYnVyZ2VycycpO1xyXG5cdGxldCBzbGlkZXNEZXNjciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5idXJnZXItZGVzY3InKTtcclxuXHRsZXQgYXJyb3dQcmV2ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFycm93LXByZXYnKTtcclxuXHRsZXQgYXJyb3dOZXh0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFycm93LW5leHQnKTtcclxuXHRsZXQgcHJpY2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnVyZ2VyLXByaWNlJyk7XHJcblxyXG5cdHNob3dTbGlkZXNJbWFnZShzbGlkZUluZGV4KTtcclxuXHRcclxuXHRmdW5jdGlvbiBzaG93U2xpZGVzSW1hZ2Uobikge1xyXG5cdFx0aWYgKG4gPiBzbGlkZXNJbWFnZS5sZW5ndGgpIHtcclxuXHRcdFx0c2xpZGVJbmRleCA9IDE7XHJcblx0XHR9IGlmIChuIDwgMSkge1xyXG5cdFx0XHRzbGlkZUluZGV4ID0gc2xpZGVzSW1hZ2UubGVuZ3RoO1xyXG5cdFx0fVxyXG5cclxuXHRcdHNsaWRlc0ltYWdlLmZvckVhY2goKGl0ZW0pID0+IHsgLy8g0J/QtdGA0LXQsdC+0YAg0LLRgdC10YUg0YHQu9Cw0LnQtNC+0LJcclxuXHRcdFx0aXRlbS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOyAvLyDQodC60YDRi9GC0Ywg0LLRgdC1INGB0LvQsNC50LTRi1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0c2xpZGVzVGl0bGUuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG5cdFx0XHRpdGVtLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcblx0XHR9KTtcclxuXHJcblx0XHRwcmljZS5mb3JFYWNoKChpdGVtKSA9PiB7XHJcblx0XHRcdGl0ZW0uc3R5bGUuZGlzcGxheSA9ICdub25lJ1xyXG5cdFx0fSlcclxuXHJcblx0XHRzbGlkZXNEZXNjci5mb3JFYWNoKChpdGVtKSA9PiB7XHJcblx0XHRcdGl0ZW0uc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuXHRcdH0pO1xyXG5cclxuXHRcdHNsaWRlc0ltYWdlW3NsaWRlSW5kZXggLSAxXS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsgLy8g0J/QvtC60LDQt9Cw0YLRjCDQv9C10YDQstGL0Lkg0YHQu9Cw0LnQtFxyXG5cdFx0c2xpZGVzVGl0bGVbc2xpZGVJbmRleCAtIDFdLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xyXG5cdFx0c2xpZGVzRGVzY3Jbc2xpZGVJbmRleCAtIDFdLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOyBcclxuXHRcdHByaWNlW3NsaWRlSW5kZXggLSAxXS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIG5leHRTbGlkZXMobikgeyAvLyDQodC80LXQvdCwINGB0LvQsNC50LTQvtCyXHJcblx0XHRzaG93U2xpZGVzSW1hZ2Uoc2xpZGVJbmRleCArPSBuKTtcclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIGN1cnJlbnRTbGlkZShuKSB7XHJcblx0XHRzaG93U2xpZGVzSW1hZ2Uoc2xpZGVJbmRleCA9IG4pO1xyXG5cdH1cclxuXHJcblx0YXJyb3dQcmV2LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcblx0XHRuZXh0U2xpZGVzKC0xKTtcclxuXHR9KTtcclxuXHJcblx0YXJyb3dOZXh0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcblx0XHRuZXh0U2xpZGVzKDEpO1xyXG5cdH0pO1xyXG5cclxuXHQvLyBWaWRlb1xyXG5cdGZ1bmN0aW9uIGZpbmRWaWRlb3MoKSB7XHJcblx0XHRsZXQgdmlkZW9zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnZpZGVvJyk7XHJcblx0XHJcblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHZpZGVvcy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRzZXR1cFZpZGVvKHZpZGVvc1tpXSk7XHJcblx0XHR9XHJcblx0fVxyXG5cdFxyXG5cdGZ1bmN0aW9uIHNldHVwVmlkZW8odmlkZW8pIHtcclxuXHRcdGxldCBsaW5rID0gdmlkZW8ucXVlcnlTZWxlY3RvcignLnZpZGVvLWxpbmsnKTtcclxuXHRcdGxldCBtZWRpYSA9IHZpZGVvLnF1ZXJ5U2VsZWN0b3IoJy52aWRlby1tZWRpYScpO1xyXG5cdFx0bGV0IGJ1dHRvbiA9IHZpZGVvLnF1ZXJ5U2VsZWN0b3IoJy52aWRlby1idXR0b24nKTtcclxuXHRcdGxldCBpZCA9IHBhcnNlTWVkaWFVUkwobWVkaWEpO1xyXG5cdFxyXG5cdFx0dmlkZW8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcblx0XHRcdGxldCBpZnJhbWUgPSBjcmVhdGVJZnJhbWUoaWQpO1xyXG5cdFxyXG5cdFx0XHRsaW5rLnJlbW92ZSgpO1xyXG5cdFx0XHRidXR0b24ucmVtb3ZlKCk7XHJcblx0XHRcdHZpZGVvLmFwcGVuZENoaWxkKGlmcmFtZSk7XHJcblx0XHR9KTtcclxuXHRcclxuXHRcdGxpbmsucmVtb3ZlQXR0cmlidXRlKCdocmVmJyk7XHJcblx0XHR2aWRlby5jbGFzc0xpc3QuYWRkKCd2aWRlb19fZW5hYmxlZCcpO1xyXG5cdH1cclxuXHRcclxuXHRmdW5jdGlvbiBwYXJzZU1lZGlhVVJMKG1lZGlhKSB7XHJcblx0XHRsZXQgcmVnZXhwID0gL2h0dHBzOlxcL1xcL2lcXC55dGltZ1xcLmNvbVxcL3ZpXFwvKFthLXpBLVowLTlfLV0rKVxcL21xZGVmYXVsdFxcLmpwZy9pO1xyXG5cdFx0bGV0IHVybCA9IG1lZGlhLnNyYztcclxuXHRcdGxldCBtYXRjaCA9IHVybC5tYXRjaChyZWdleHApO1xyXG5cdFxyXG5cdFx0cmV0dXJuIG1hdGNoWzFdO1xyXG5cdH1cclxuXHRcclxuXHRmdW5jdGlvbiBjcmVhdGVJZnJhbWUoaWQpIHtcclxuXHRcdGxldCBpZnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpZnJhbWUnKTtcclxuXHRcclxuXHRcdGlmcmFtZS5zZXRBdHRyaWJ1dGUoJ2FsbG93ZnVsbHNjcmVlbicsICcnKTtcclxuXHRcdGlmcmFtZS5zZXRBdHRyaWJ1dGUoJ2FsbG93JywgJ2F1dG9wbGF5Jyk7XHJcblx0XHRpZnJhbWUuc2V0QXR0cmlidXRlKCdzcmMnLCBnZW5lcmF0ZVVSTChpZCkpO1xyXG5cdFx0aWZyYW1lLmNsYXNzTGlzdC5hZGQoJ3ZpZGVvLW1lZGlhJyk7XHJcblx0XHJcblx0XHRyZXR1cm4gaWZyYW1lO1xyXG5cdH1cclxuXHRcclxuXHRmdW5jdGlvbiBnZW5lcmF0ZVVSTChpZCkge1xyXG5cdFx0bGV0IHF1ZXJ5ID0gJz9yZWw9MCZzaG93aW5mbz0wJmF1dG9wbGF5PTEnO1xyXG5cdFxyXG5cdFx0cmV0dXJuICdodHRwczovL3d3dy55b3V0dWJlLmNvbS9lbWJlZC8nICsgaWQgKyBxdWVyeTtcclxuXHR9XHJcblx0XHJcblx0ZmluZFZpZGVvcygpO1xyXG5cdFxyXG5cclxuXHQvLyBZYW5kZXggTWFwIFxyXG5cdHltYXBzLnJlYWR5KCk7XHJcblxyXG5cdGxldCBteVBsYWNlbWFya3MgPSBbXHJcblx0XHR7XHJcblx0XHRcdGxhdGl0dWRlOiA1OS45NyxcclxuXHRcdFx0bG9uZ2l0dWRlOiAzMC4zMSxcclxuXHRcdFx0aGludENvbnRlbnQ6ICfRg9C7LiDQm9C40YLQtdGA0LDRgtC+0YDQvtCyLCDQtC4gMTnQkCcsXHJcblx0XHRcdGJhbGxvb25Db250ZW50OiBbXHJcblx0XHRcdFx0JzxkaXYgY2xhc3M9XCJtYXAtYmFsbG9vblwiPicsXHJcblx0XHRcdFx0XHQnPHN2ZyBjbGFzcz1cIm1hcC1iYWxsb29uX19pbWdcIj4nLFxyXG5cdFx0XHRcdFx0XHQnPHVzZSB4bGluazpocmVmPVwiaW1hZ2Uvc3ZnL3Nwcml0ZS5zdmcjbG9nb1wiPjwvdXNlPicsXHRcclxuXHRcdFx0XHRcdCc8L3N2Zz4nLFxyXG5cdFx0XHRcdFx0J9GD0LsuINCb0LjRgtC10YDQsNGC0L7RgNC+0LIsINC0LiAxOdCQJyxcclxuXHRcdFx0XHQnPC9kaXY+J1xyXG5cdFx0XHRdXHJcblx0XHR9LFxyXG5cdFx0e1xyXG5cdFx0XHRsYXRpdHVkZTogNTkuOTQ1LCAgXHJcblx0XHRcdGxvbmdpdHVkZTogMzAuMzgsXHJcblx0XHRcdGhpbnRDb250ZW50OiAn0JrQsNC70YPQttGB0LrQuNC5INC/0LXRgNC10YPQu9C+0LosIDknLFxyXG5cdFx0XHRiYWxsb29uQ29udGVudDogW1xyXG5cdFx0XHRcdCc8ZGl2IGNsYXNzPVwibWFwLWJhbGxvb25cIj4nLFxyXG5cdFx0XHRcdFx0JzxzdmcgY2xhc3M9XCJtYXAtYmFsbG9vbl9faW1nXCIgPicsXHJcblx0XHRcdFx0XHRcdCc8dXNlIHhsaW5rOmhyZWY9XCJpbWFnZS9zdmcvc3ByaXRlLnN2ZyNsb2dvXCI+PC91c2U+JyxcdFxyXG5cdFx0XHRcdFx0Jzwvc3ZnPicsXHJcblx0XHRcdFx0XHQn0JrQsNC70YPQttGB0LrQuNC5INC/0LXRgNC10YPQu9C+0LosIDknLFxyXG5cdFx0XHRcdCc8L2Rpdj4nXHJcblx0XHRcdF1cclxuXHRcdH0sXHJcblx0XHR7XHJcblx0XHRcdGxhdGl0dWRlOiA1OS44OSxcclxuXHRcdFx0bG9uZ2l0dWRlOiAzMC4zMixcclxuXHRcdFx0aGludENvbnRlbnQ6ICfQnNC+0YHQutC+0LLRgdC60LjQuSDQv9GA0L7RgdC/0LXQutGCLCAxMDknLFxyXG5cdFx0XHRiYWxsb29uQ29udGVudDogW1xyXG5cdFx0XHRcdCc8ZGl2IGNsYXNzPVwibWFwLWJhbGxvb25cIj4nLFxyXG5cdFx0XHRcdFx0JzxzdmcgY2xhc3M9XCJtYXAtYmFsbG9vbl9faW1nXCI+JyxcclxuXHRcdFx0XHRcdFx0Jzx1c2UgeGxpbms6aHJlZj1cImltYWdlL3N2Zy9zcHJpdGUuc3ZnI2xvZ29cIj48L3VzZT4nLFx0XHJcblx0XHRcdFx0XHQnPC9zdmc+JyxcclxuXHRcdFx0XHRcdCfQnNC+0YHQutC+0LLRgdC60LjQuSDQv9GA0L7RgdC/0LXQutGCLCAxMDknLFxyXG5cdFx0XHRcdCc8L2Rpdj4nXHJcblx0XHRcdF1cclxuXHRcdH0sXHJcblx0XHR7XHJcblx0XHRcdGxhdGl0dWRlOiA1OS45MTgsXHJcblx0XHRcdGxvbmdpdHVkZTogMzAuNDkzLFxyXG5cdFx0XHRoaW50Q29udGVudDogJ9GD0LvQuNGG0LAg0J/QvtC00LLQvtC50YHQutC+0LPQviwgNDInLFxyXG5cdFx0XHRiYWxsb29uQ29udGVudDogW1xyXG5cdFx0XHRcdCc8ZGl2IGNsYXNzPVwibWFwLWJhbGxvb25cIj4nLFxyXG5cdFx0XHRcdFx0JzxzdmcgY2xhc3M9XCJtYXAtYmFsbG9vbl9faW1nXCI+JyxcclxuXHRcdFx0XHRcdFx0Jzx1c2UgeGxpbms6aHJlZj1cImltYWdlL3N2Zy9zcHJpdGUuc3ZnI2xvZ29cIj48L3VzZT4nLFx0XHJcblx0XHRcdFx0XHQnPC9zdmc+JyxcclxuXHRcdFx0XHRcdCfRg9C70LjRhtCwINCf0L7QtNCy0L7QudGB0LrQvtCz0L4sIDQyJyxcclxuXHRcdFx0XHQnPC9kaXY+J1xyXG5cdFx0XHRdXHJcblx0XHR9XHJcblx0XTtcclxuXHJcblx0eW1hcHMucmVhZHkoZnVuY3Rpb24gKCkgeyAgICAgXHJcblx0XHRsZXQgbXlNYXAgPSBuZXcgeW1hcHMuTWFwKCdtYXAnLCB7XHJcblx0XHRcdFx0Y2VudGVyOiBbNTkuOTQsIDMwLjMyXSxcclxuXHRcdFx0XHR6b29tOiAxMSxcclxuXHRcdFx0XHRjb250cm9sczogWyd6b29tQ29udHJvbCddLFxyXG5cdFx0XHRcdGJlaGF2aW9yczogWydkcmFnJ11cclxuXHRcdH0sIHtcclxuXHRcdFx0XHRzZWFyY2hDb250cm9sUHJvdmlkZXI6ICd5YW5kZXgjc2VhcmNoJ1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0bGV0IGN1c3RvbUljb24gPSB5bWFwcy50ZW1wbGF0ZUxheW91dEZhY3RvcnkuY3JlYXRlQ2xhc3MoJzxzdmcgd2lkdGg9XCI0NlwiIGhlaWdodD1cIjU3XCI+PHVzZSB4bGluazpocmVmPVwiaW1hZ2Uvc3ZnL3Nwcml0ZS5zdmcjbWFwLW1hcmtlclwiPjwvdXNlPjwvc3ZnPicpO1xyXG5cclxuXHRcdG15UGxhY2VtYXJrcy5mb3JFYWNoKGZ1bmN0aW9uKG9iaikge1xyXG5cdFx0XHRsZXQgbXlQbGFjZW1hcmsgPSBuZXcgeW1hcHMuUGxhY2VtYXJrKFtvYmoubGF0aXR1ZGUsIG9iai5sb25naXR1ZGVdLCB7IFxyXG5cdFx0XHRcdGhpbnRDb250ZW50OiBvYmouaGludENvbnRlbnQsIFxyXG5cdFx0XHRcdGJhbGxvb25Db250ZW50OiBvYmouYmFsbG9vbkNvbnRlbnQuam9pbignJykgXHJcblx0XHRcdH0sXHJcblx0XHRcdHtcclxuXHRcdFx0XHRpY29uTGF5b3V0OiAnZGVmYXVsdCNpbWFnZScsXHJcblx0XHRcdFx0aWNvbkltYWdlSHJlZjogJ2ltYWdlL3N2Zy9tYXAtbWFya2VyLnN2ZycsXHJcblx0XHRcdFx0aWNvbkltYWdlU2l6ZTogWzQ2LCA1N10sXHJcblx0XHRcdFx0aWNvbkltYWdlT2Zmc2V0OiBbLTIzLCAtNTddXHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0XHRteU1hcC5nZW9PYmplY3RzLmFkZChteVBsYWNlbWFyayk7XHJcblx0XHR9KTtcclxuXHR9KTtcclxuXHRcclxufSk7Il19
